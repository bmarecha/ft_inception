version: '3'
services:
 db:
  networks:
   - my_network
  build: requirements/mariadb/
  volumes:
   - db_data:/var/lib/mysql
  restart: always

 wordpress:
  networks:
   - my_network
  depends_on:
   - db
  build: requirements/wordpress/
  volumes:
   - wp_data:/var/www
  restart: always

 nginx:
  networks:
   - my_network
  depends_on:
   - wordpress
  build: requirements/nginx/
  volumes:
   - wp_data:/var/www
  ports:
   - "443:443"
   - "8080:80"
  restart: always

volumes:
 db_data:
  driver: local
  driver_opts:
   type: 'none'
   o: 'bind'
   device: '${HOME}/db'
 wp_data: 
  driver: local
  driver_opts:
   type: 'none'
   o: 'bind'
   device: '${HOME}/wp'

networks:
  my_network:
    driver: bridge
